10 FILESA,B
20 DIM A$(62),B$(62),C$(62),X$(62)
30 PRINT ""
40 PRINT "   ISTO E VIDA   ----- BENVINDO -----"
50 PRINT ""
60 M4=M5=S4=0
70 GOTO 1410
80 A$(1,62)=" "
90 FOR R=1 TO 62
100 PRINT#1,R;A$
110 PRINT#2,R;A$
120 NEXT R
130 PRINT "QUAL E A PRIMEIRA LINHA DOS PAIS";
140 INPUT R
150 F1=R-1
160 PRINT "LINHA"R;TAB(8);
170 INPUT B$
180 IF B$="DONE" THEN 280
180 IF R>60 THEN 280
190 IF R>60 THEN 280
200 IF LEN(B$)=62 THEN 230
210 Q=62-LEN(B$)
220 B$(LEN(B$)+1,62)=A$(1,Q)
230 C$(1,1)=" "
240 C$(2,62)=B$(1,61)
250 PRINT#2,R;C$
260 R=R+1
270 GOTO1 60
280 L1=R
290 PRINT ""
300 T9=0
310 FOR Z=O1 TO O2
320 IF T9#0 THEN 350
330 Z=Z-1
340 GOTO 810
350 IF F1<2 THEN 1910
360 IF L1>59 THEN 2080
370 READ#1,F1-1;B$
380 READ#1,F1;C$
390 READ H$
400 M4=M5=S4=0
410 IF H$#"1" THEN 430
420 RESTORE
430 FOR R=F1 TO L1
440 A$=B$
450 B$=C$
460 READ#1,R+1;C$
470 X$(1,1)=" "
480 FOR Q=2 TO 61
490 M=0
500 FOR N=Q-1 TO Q+1
510 IF A$(N,N)=" " THEN 530
520 M=M+1
530 NEXT N
540 IF B$(Q-1,Q-1)=" " THEN 560
550 M=M+1
560 IF B$(Q+1,Q+1)=" " THEN 580
570 M=M+1
580 FOR N=Q-1 TO Q+1
590 IF C$(N,N)=" " THEN 610
600 M=M+1
610 NEXT N
620 IF M#3 THEN 660
630 IF B$(Q,Q)#" " THEN 680
640 X$(Q,Q)=H$
650 GOTO 710
660 IF B$(Q,Q)=" " THEN 700
670 IF M#2 THEN 700
680 X$(Q,Q)=B$(Q,Q)
690 GOTO 710
700 X$(Q,Q)=" "
710 NEXT Q
720 IF X$(2,2)=" " THEN 740
730 M4=M4+1
740 IF X$(61,61)=" " THEN 760
750 M5=M5+1
760 X$(62,62)=" "
770 PRINT#2,R;X$
780 NEXT R
790 IF M4#0 THEN 1720
800 IF M5#0 THEN 1800
810 S9=1
820 T1=F1-1
830 IF F1-1>=1 THEN 850
840 T1=T1+1
850 T2=L1
860 GOSUB 1160
870 R1=R
880 T1=L1
890 S9=-1
900 T2=F1
910 GOSUB 1160
920 IF R>=R1 THEN 950
930 PRINT "A VIDA AGORA ACABOU -- GERACAO #"Z
940 STOP
950 F1=R1-1
960 L1=R+1
970 IF T9=0 THEN 990
980 IF Z<E9OR(Z-E9)/F9#INT((Z-E9)/F9) THEN 1090
990 T9=1
1000 PRINT "GERACAO #"Z";""
1010 FOR T1=R1 TO R
1020 READ#2,T1;X$
1030 FOR M=61 TO 2 STEP -1
1040 IF X$(M,M)#" " THEN 1060
1050 NEXT M
1060 PRINT "LINHA"T1;TAB(10);X$(1,M)
1070 NEXT T1
1080 PRINT ""
1090 FOR R=1 TO 62
1100 READ#2,R;X$
1110 PRINT#1,R;X$
1120 NEXT R
1130 NEXT Z
1140 DATA "2","3","4","5","6","7","8","9","0","1","X"
1150 STOP
1160 PRINT""
FOR R=T1+1 TO T2 STEP S9
1170 READ#2,R;X$
1160 FOR R=T1+1 TO T2 STEP S9
1180 FOR W7=1 TO 62
1181 IF X$(W7,W7)#" " THEN 1200
1182 NEXT W7
1190 NEXT R
1200 RETURN
1210 PRINT "VAI ENTRAR COM A PRIMEIRA GERACAO";
1220 INPUT A$
1230 IF A$#"NAO" THEN 1330
1240 PRINT "QUAL E O NUMERO DA PRIMEIRA GERACAO A SER IMPRESSA";
1240 PRINT "QUAL E O NUMERO DA PRIMEIRA GERACAO A SER IMPRESSA";
1250 INPUT O1
1260 O1=O1-1
1270 FOR R=2 TO O1-1
1280 READ H$
1290 IF H$="1" THEN 1310
1300 RESTORE
1290 IF H$#"1" THEN 1310
1310 NEXT R
1320 GOTO 1340
1330 O1=2
1340 PRINT "QUAL E A ULTIMA GERACAO";
1350 INPUT O2
1360 PRINT "QUAL A PRIMEIRA GERACAO A SER IMPRESSA";
1240 PRINT "QUAL E A GERACAO A ENTRAR";
1370 INPUT E9
1380 PRINT "QUAL E INTERVALO ENTRE AS GERACOES";
1390 INPUT F9
1400 GOTO 80
1660 READ#1,1
1410 PRINT "VOCE NAO QUER INSTRUCOES !!!"
1670 GOTO 1210
1680 PRINT "ESCREVA SIM OU NAO"
1690 GOTO 1410
1700 PRINT "ERRO A ESQUERDA E A DIREITA"
1710 GOTO 810
1720 PRINT "ERRO A ESQUERDA, CORRECAO FEITA UM ESPACO A DIREITA"
1730 FOR D=F1 TO L1
1740 READ#1,D;A$
1750 A$(1,1)=" "
1760 A$(2,62)=A$(1,61)
1770 PRINT#1,D;A$
1780 NEXT D
1790 GOTO 1860
1800 PRINT "ERRO A DIREITA, CORRECAO FEITA UM ESPACO A ESQUERDA"
1810 FOR D=F1 TO L1
1820 READ#1,D;A$
1830 A$(1,62)=A$(2,62)
1840 PRINT#1,D;A$
1850 NEXT D
1860 READ#!,F1;C$
1870 M4=M5=0
1880 READ#1,F1;C$
1860 READ#1,F1-1;B$
1890 S4=1
1900 IF L1=60
1900 GOTO 430
1910 IF L1=60 THEN 2210
1920 B$(1,62)=" "
1930 PRINT "ERRO DE ALTURA - CORRECAO SENDO FEITA UMA LINHA PARA BAIXO"
1940 READ#1,1;A$
1950 PRINT#1,1;A$
1960 FOR R=1 TO 59
1970 READ#1,R;B$
1980 PRINT#1,1;B$
1990 A$=B$
2000 NEXT R
2010 B$(1,62)=" "
2020 F1=F1+1
2030 L1=L1+1
2040 FOR R=1 TO 62
2050 PRINT#2,R;B$
2060 NEXT R
2070 GOTO 350
2080 PRINT "ERRO DE ALTURA - CORRECAO SENDO FEITA UMA LINHA PARA CIMA"
2090 READ#1,60;A$
2100 B$(1,62)=" "
2110 PRINT#1,60;B$
2120 FOR R=60 TO 2
2130 READ#1,R-1;B$
2140 PRINT#1,R-1;A$
2150 A$=B$
2160 NEXT R
2170 L1=L1-1
2180 F1=F1-1
2190 B$(1,62)=" "
2200 GOTO 2040
2210 PRINT "ERRO ACIMA E ABAIXO- LIMITE EXCEDIDO"
2220 PRINT "   PROGRAMA TERMINADO      ****** SINTO MUITO ******"
2230 END
