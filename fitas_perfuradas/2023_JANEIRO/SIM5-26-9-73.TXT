10  REM ***** PROGRAMA PARA SIMULAR UM COMPUTADOR OPERANDO EM DOS *****
20  DEF FNA(X)=INT((X+3)/4)
30  DEF FNB(X)=X-INT((X-1)/4)*4
40  DIM A$[30],B$[30],C$[10],D$[31],E$[30],F$[30]
50  DIM A[201],B[200],X[9]
60  FILES A,B
70  MAT A=ZER
80  MAT B=ZER
90  C$="0123456789"
100  DATA "TA","FI","CA","MU","LI","PE","EX","GU","CH","CO"
110  DATA "CAX","MDX","SOX","SUX","MUX","DIX","ARX"
120  DATA "CAR","ARM","SOM","SUB","MUL","DIV","IMP","IML"
130  DATA "LE ","MDM","DAI","PAR","DC ","NOP","MAD","MAE"
140  DATA "DZ ","DP ","DN ","DO ","D  ","DM ","BIB"
150  DATA "IS ","ABS","EXP","LOG","INT","SQR","RND","SIN","COS","ATN"
160  B0=T=0
170  PRINT "@";
180  INPUT A$
190  IF A$[1,1]=":" THEN 220
200  PRINT "???"
210  GOTO 170
220  FOR I=1 TO 10
230  IF T#0 OR I<3 THEN 260
240  PRINT "IGNORADO"
250  GOTO 320
260  READ B$
270  IF A$[2,3]=B$ THEN 310
280  NEXT I
290  PRINT "COMANDO INCORRETO ; REENTRE-O NOVAMENTE"
300  GOTO 320
310  GOSUB I OF 340,3440,360,2710,2530,2480,1150,3230,3320,480
320  RESTORE 
330  GOTO 170
340  T=1
350  RETURN 
360  PRINT #1,1
370  W=0
380  INPUT D$[1,31]
390  IF D$[1,1]#"'" THEN 410
400  D$[1,30]=D$[2,31]
410  IF W<100 THEN 440
420  PRINT "PROGRAMA MUITO LONGO"
430  RETURN 
440  PRINT #1;D$[1,30]
450  W=W+1
460  IF D$[5,7]#"FIM" THEN 380
470  RETURN 
480  B0=1
490  FOR I=1 TO W-1
500  READ #1,FNA(I)
510  FOR K=1 TO FNB(I)
520  READ #1;B$
530  NEXT K
540  J=L=0
550  IF B$[1,1]="*" THEN 1100
560  FOR J=1 TO 30
570  READ A$
580  IF A$=B$[5,7] THEN 640
590  NEXT J
600  C0=1
610  PRINT "ERRO";C0;"NA INSTRUCAO";I
620  B0=J=0
630  GOTO 1100
640  IF J=29 THEN 1100
650  IF J#30 THEN 730
660  FOR L=1 TO 10
670  READ A$
680  IF B$[12,14]=A$ THEN 1100
690  NEXT L
700  L=0
710  C0=3
720  GOTO 610
730  FOR B=2 TO 10
740  IF B$[10,10]=C$[B,B] THEN 790
750  NEXT B
760  B=1
770  C0=4
780  IF J<8 THEN 610
790  J=J+100*(B-1)
800  IF B$[9,9]#"I" THEN 820
810  J=-J
820  G=12
830  X=31
840  V=-1
850  IF B$[G,G]="-" THEN 880
860  V=1
870  IF B$[G,G]#"+" THEN 1020
880  FOR H=1+G TO 30
890  IF B$[H,H]=" " THEN 980
900  IF B$[H,H]#"." THEN 930
910  X=H+1
920  GOTO 970
930  FOR K=1 TO 10
940  IF B$[H,H]=C$[K,K] THEN 960
950  NEXT K
960  L=10*L+K-1
970  NEXT H
980  L=L*V
990  IF X>H THEN 1100
1000  L=L/10^(H-X)
1010  GOTO 1100
1020  IF B$[12,14]="   " THEN 1100
1030  READ #1,1
1040  FOR L=1 TO W-1
1050  READ #1;A$
1060  IF A$[1,31=B$[12,14] THEN 1100
1070  NEXT L
1080  C0=2
1090  GOTO 610
1100  A[I]=J
1110  B[I]=L
1120  RESTORE 110
1130  NEXT I
1140  RETURN 
1150  IF B0=1 THEN 1200
1160  PRINT "EXECUCAO IMPOSSIVEL"
1170  RETURN 
1180  E0=2
1190  GOTO 1250
1200  A=O=0
1210  MAT X=ZER
1220  I1=1
1230  IF I1<W AND I1>0 THEN 1290
1240  E0=1
1250  PRINT "ERRO";E0;"EXECUCAO SUSPENSA"
1260  RETURN 
1270  PRINT "FIM DA EXECUCAO"
1280  RETURN 
1290  IF A[I1]=0 THEN 1460
1300  B=B[I1]
1310  A2=ABS(A[I1])
1320  I5=INT(A2/100)
1330  A5=A2-100*I5
1340  IF I5=0 OR A5<8 THEN 1360
1350  B=B+X[I5]
1360  IF A[I1] >= 0 THEN 1390
1370  IF B<1 OR B >= W THEN 1240
1380  B=B[B]
1390  GOTO A5 OF 1960,2000,1650,1690,1860,1900
1400  IF B<1 OR B >= W THEN 1430
1410  GOTO A5-6 OF 1980,1480,1500,1650,1690,1860
1420  GOTO A5-12 OF 1900,1730,1750,1770,1790,1830
1430  GOTO A5-18 OF 1270,1180,1460,2120,200,1520
1440  GOTO A5-24 OF 1550,1580,1610,1590,2170,2230
1450  GOTO 1240
1460  I1=I1+1
1470  GOTO 1230
1480  A=B[B]
1490  GOTO 1460
1500  B[B]=A
1510  GOTO 1460
1520  IF A#0 THEN 1460
1530  I1=B-1
1540  GOTO 1460
1550  IF A <= 0 THEN 1460
1560  I1=B-1
1570  GOTO 1460
1580  IF A >= 0 THEN 1460
1590  I1=B-1
1600  GOTO 1460
1610  IF O=0 THEN 1460
1620  I1=B-1
1630  O=0
1640  GOTO 1460
1650  A=A+B[B]
1660  IF ABS(A)<10^6 THEN 1460
1670  O=1
1680  GOTO 1460
1690  A=A-B[B]
1700  GOTO 1660
1710  O=1
1720  GOTO 1460
1730  PRINT B[B]
1740  GOTO 1460
1750  PRINT B[B];
1760  GOTO 1460
1770  INPUT B[B]
1780  GOTO 1460
1790  B[B]=B[B]-1
1800  IF B[B]#0 THEN 1460
1810  I1=I1+1
1820  GOTO 1460
1830  B[B]=I1
1840  I1=B
1850  GOTO 1460
1860  A=A*B[B]
1870  GOTO 1660
1880  O=1
1890  GOTO 1460
1900  IF B[B]#0 THEN 1940
1910  A=SGN(A)*10^38
1920  PRINT "DIVISAO POR ZERO"
1930  GOTO 1670
1940  A=A/B[B]
1950  GOTO 1660
1960  X[I5]=B
1970  GOTO 1460
1980  B[B]=X[I5]
1990  GOTO 1460
2000  L6=X[I5]+B
2010  IF X[I5]=0 OR SGN(X[I5])=SGN(L6) THEN 2030
2020  I1=I1+1
2030  X[I5]=L6
2040  GOTO 1460
2050  A=-A
2060  GOTO 1460
2070  IF B <= 0 THEN 1460
2080  FOR F2=1 TO B
2090  A=INT(A/10)
2100  NEXTF2
2110  GOTO 1460
2120  IF B <= 0 THEN 1460
2130  FOR F2=1 TO B
2140  A=10*(A-INT(A/100000.)*100000.)
2150  NEXT F2
2160  GOTO 1460
2170  GOSUB 3370
2180  FOR K7=12 TO 30
2190  IF A$[K7,K7]="'" THEN 1460
2200  PRINT A$[K7,K7];
2210  NEXT K7
2220  GOTO 1460
2230  GOTO B OF 2260,2280,2300,2320,2360,2380,2420,2440,2460
2240  A=ATN(A)
2250  GOTO 1460
2260  A=-A
2270  GOTO 1460
2280  A=ABS(A)
2290  GOTO 1460
2300  A=EXP(A)
2310  GOTO 1460
2320  E0=3
2330  IF A <= 0 THEN 1250
2340  A=LOG(A)
2350  GOTO 1460
2360  A=INT(A)
2370  GOTO 1460
2380  E0=4
2390  IF A<0 THEN 1250
2400  A=SQR(A)
2410  GOTO 1460
2420  A=RND(0)
2430  GOTO 1460
2440  A=SIN(A)
2450  GOTO 1460
2460  A=COS(A)
2470 GOTO 1460
2480  PRINT ""
2490  FOR S5=1 TO 1000
2500  NEXT S5
2510  R3=0
2520  GOTO 2550
2530  PRINT ""
2540  R3=1
2550  READ #1,1
2560  FOR M7=1 TO W
2570  READ #1;A$
2580  IF R3=1 THEN 2620
2590  IF A$[1,1]#" " THEN 2630
2600  PRINT "'";
2610  GOTO 2630
2620  PRINT "LINHA";M7;
2630  FOR F=30 TO 1 STEP -1
2640  IF A$[F,F]#" " THEN 2660
2650  NEXT F
2660  PRINT A$[1,F]
2670  NEXT M7
2680  PRINT ""0690  RETURN 
2700  PRINT "???"
2710  H=0
2720  INPUT B$
2730  IF B$[1,1]="/" THEN 2750
2740  IF H=1 THEN 2970
2750  IF B$[2,2]#"F" THEN 2770
2760  RETURN 
2770  H=1
2780  IF B$[2,2]="I" THEN 2960
2790  H=2
2800  IF B$[2,2]="S" THEN 2920
2810  IF B$[2,2]#"A" THEN 2700
2820  INPUT A
2830  I1=A
2840  GOSUB 3110
2850  W=W-1
2860  FOR G=A TO W
2870  READ #1;B$
2880  GOSUB 3110
2890  READ #1;A$
2900  NEXT G
2910  GOTO 2710
2920  INPUT S
2930  INPUT A$
2940  GOSUB 3110
2950  GOTO 2720
2960  INPUT X1
2970  I1=X1
2980  GOSUB 3370
2990  G=I1
3000  D$=A$
3010  G=G+1
3020  GOSUB 3110
3030  IF G<W THEN 3080
3040  X1=X1+1
3050  W=W+1
3060  IF W>99 THEN 420
3070  GOTO 2720
3080  B$=D$[1,30]
3090  READ #1;D$
3100  GOTO 3010
3110  G0=INT(G+3)/4
3120  READ #1,FNA(S);B$,D$,E$,F$
3130  GOTO FNB(S) OF 3160,3180,3200
3140  F$=A$
3150  GOTO 3210
3160  B$=A$
3170  GOTO 321
3180  D$=A$
3190 GOTO 3210
3200  E$=A$
3210  PRINT #1,FNA(S);B$,D$,E$,F$
3220  RETURN 
3230  PRINT #2,1
3240  PRINT #2;W
3250  FOR T0=1 TO W-1
3260  PRINT #2;A[T0]
3270  NEXT T0
3280  FOR T0=1 TO W-1
3290  PRINT #2;B[T0]
3300  NEXT T0
3310  RETURN 
3320  READ #2,1
3330  READ #2;W
3340  MAT READ #2;A[W-1]
3350  MAT  READ #2;B[W-1]
3360  RETURN 3370  READ #1,1
3380 IF I1#0 THEN 340
3390  RETURN 
340  FOR K7=1 TO I1	3410  READ #1;A$
3420  NEXT K7
3430  RETURN 
3440  END 
